<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Dodies Host View</title>
<style>
body{font-family:sans-serif;background:#111;color:#fff}
.party{border:1px solid #444;padding:12px;margin:8px;border-radius:8px}
button{margin-right:6px}
</style>
</head>
<body>

<h2>Waitlist</h2>
<div id="list"></div>

<script>
const APPS = localStorage.getItem("appsScriptUrl") || "PASTE_YOUR_EXEC_URL";

async function load(){
  const r = await fetch(APPS+"?action=getWaitlist");
  const j = await r.json();
  render(j.data||[]);
}

function render(arr){
  const d=document.getElementById('list');
  d.innerHTML='';
  arr.forEach(p=>{
    if(!p.name) return;
    const card=document.createElement('div');
    card.className='party';
    card.innerHTML=
      "<b>"+p.name+"</b> ("+p.partySize+") â€” "+p.status+
      "<br><button onclick='seat("+p.row+")'>Seat</button>"+
      "<button onclick='notify("+p.row+")'>Notify</button>";
    d.appendChild(card);
  });
}

async function seat(row){
  await fetch(APPS,{
    method:"POST",
    headers:{'Content-Type':'text/plain'},
    body:JSON.stringify({
      action:"updateWaitlistStatus",
      row:row,
      status:"Seated"
    })
  });
  load();
}

async function notify(row){
  await fetch(APPS,{
    method:"POST",
    headers:{'Content-Type':'text/plain'},
    body:JSON.stringify({
      action:"updateWaitlistStatus",
      row:row,
      status:"Notified"
    })
  });
  load();
}

load();
</script>
</body>
</html>
